<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cross-Entropy Clustering • CEC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Cross-Entropy Clustering">
<meta property="og:description" content="Clustering that splits data into Gaussian type clusters. The 
    implementation allows the simultaneous use of various type Gaussian mixture 
    models, performs the reduction of unnecessary clusters and it's able to 
    discover new groups. Based on Spurek, P. and Tabor, J. (2014) 
    &lt;doi:10.1016/j.patcog.2014.03.006&gt;.">
<meta property="og:image" content="https://swarm-lab.github.io/cec/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CEC</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/swarm-lab/cec/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="cec---cross-entropy-clustering-">CEC - Cross Entropy Clustering <img src="reference/figures/logo.png" align="right" alt="" width="120"><a class="anchor" aria-label="anchor" href="#cec---cross-entropy-clustering-"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>The R Package CEC performs clustering based on the cross–entropy clustering (CEC) method, which has been recently developed with the use of information theory. The main advantage of CEC is that it combines the speed and simplicity of k-means with the ability to use various Gaussian mixture models and reduce unnecessary clusters.</p>
<p>The CEC package is a part of CRAN repository and it can be installed by the following command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"CEC"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/swarm-lab/cec" class="external-link">"CEC"</a></span><span class="op">)</span></span></code></pre></div>
<p>The basic usage comes down to the function <code>cec</code> with two arguments: input data (<code>x</code>) and the initial number of centers (<code>centers</code>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...</span>, centers <span class="op">=</span> <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>Below, a simple session with <strong>R</strong> is presented, where the component (waiting) of the Old Faithful data set is split into two clusters:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/swarm-lab/cec" class="external-link">"CEC"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">waiting</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cec</span><span class="op">)</span></span></code></pre></div>
<p>As the main result, CEC returns data cluster membership <code>cec$cluster</code>. The following parameters of clusters can be obtained as well:</p>
<ul>
<li>means (<code>cec$centers</code>)</li>
<li>covariances (<code>cec$covariances.model</code>)</li>
<li>probabilities (<code>cec$probability</code>)</li>
</ul>
<p>Additional information concerning the number of iterations, cost (energy) function and the number of clusters at each iteration are also available.</p>
<p>Below, a session of <strong>R</strong> is presented which shows how to use the above parameters for plotting the data and the Gaussian models corresponding to the clusters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">waiting</span>, prob <span class="op">=</span> <span class="cn">T</span>, main <span class="op">=</span> <span class="st">"Time between Old Faithful eruptions"</span>, xlab <span class="op">=</span> <span class="st">"Minutes"</span>, </span>
<span>col <span class="op">=</span> <span class="st">"lightgray"</span>, border <span class="op">=</span> <span class="fl">0</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">cec</span><span class="op">$</span><span class="va">probability</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">cec</span><span class="op">$</span><span class="va">centers</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">cec</span><span class="op">$</span><span class="va">covariances.model</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>add <span class="op">=</span> <span class="cn">T</span>, col <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/old.png"></p>
<p>The CEC method, analogously to k-means, depends on the initial clusters memberships. Therefore, the initialization should be started a few times, which can be achieved using the <code>nstart</code> parameter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...</span>,  centers <span class="op">=</span> <span class="va">...</span>, nstart <span class="op">=</span> <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p><strong>Multiple threads can be used to speed up clustering (when <code>nstart &gt; 1</code> ).</strong> It’s driven by the <code>threads</code> parameter (more details in the package manual).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">...</span>, nstart <span class="op">=</span> <span class="fl">100</span>, threads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>The initial locations of the centers can be chosen either <strong>randomly</strong> or using the <strong>k-means++</strong> method and it’s driven by the <code>centers.init</code> parameter which can take one of the two values: <code>"random"</code> or <code>"kmeans++"</code>.</p>
<p>Two essential parameter, in the context of CEC method, are <code>card.min</code> and <code>iter.max</code> that express minimal cluster size - the number of points, below which, the cluster is removed and the maximum number of iterations at each start, respectively.</p>
<p>One of the most important properties of the CEC algorithm is that it can be applied to various Gaussian models. The CEC package includes the implementation of six Gaussian models, which can be specified by the parameter <code>type</code>.</p>
</div>
<div class="section level2">
<h2 id="implemented-gaussian-models-families">Implemented Gaussian models (families)<a class="anchor" aria-label="anchor" href="#implemented-gaussian-models-families"></a>
</h2>
<div class="section level3">
<h3 id="general-gaussian-distributions">General Gaussian distributions<a class="anchor" aria-label="anchor" href="#general-gaussian-distributions"></a>
</h3>
<p><strong><code>type = "all"</code></strong></p>
<p>The general Gaussian CEC algorithm gives similar results to those obtained by the Gaussian Mixture Models. However, the CEC does not use the EM (Expectation Maximization) approach for minimization but a simple iteration process (Hartigan method). Consequently, larger data sets can be processed in shorter time.</p>
<p>The clustering will have a tendency to divide the data into clusters in the shape of ellipses (ellipsoids in higher dimensions).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fourGaussians"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">fourGaussians</span>, centers <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"all"</span>, nstart <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/all.png"></p>
</div>
<div class="section level3">
<h3 id="spherical-cec">Spherical CEC<a class="anchor" aria-label="anchor" href="#spherical-cec"></a>
</h3>
<p><strong><code>type = "spherical"</code></strong></p>
<p>The original distribution will be estimated by spherical (radial) densities, which will result in splitting the data into circle-like clusters of arbitrary sizes (balls in higher dimensions).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tset</span>, centers <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"spherical"</span>, nstart <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/spherical.png"></p>
</div>
<div class="section level3">
<h3 id="spherical-cec-with-fixed-radius">Spherical CEC with fixed radius<a class="anchor" aria-label="anchor" href="#spherical-cec-with-fixed-radius"></a>
</h3>
<p><strong><code>type = "fixedr"</code></strong></p>
<p>Similarly to the general spherical model, the dataset will be divided into clusters resembling full circles, but with the radius determined by the <code>param</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tset</span>, centers <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"fixedr"</span>, param <span class="op">=</span> <span class="fl">0.01</span>, nstart <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/fixedr.png"></p>
</div>
<div class="section level3">
<h3 id="diagonal-cec">Diagonal CEC<a class="anchor" aria-label="anchor" href="#diagonal-cec"></a>
</h3>
<p><strong><code>type = "diagonal"</code></strong></p>
<p>In this case, the data will be described by ellipses for which the main semi-major axes are parallel to the axes of the coordinate system.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tset</span>, centers <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"diagonal"</span>, nstart <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/diagonal.png"></p>
</div>
<div class="section level3">
<h3 id="fixed-covariance-cec">Fixed covariance CEC<a class="anchor" aria-label="anchor" href="#fixed-covariance-cec"></a>
</h3>
<p><strong><code>type = "covariance"</code></strong></p>
<p>This model contains Gaussians with fixed covariance matrix.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tset</span>, centers <span class="op">=</span> <span class="fl">10</span>, card.min <span class="op">=</span> <span class="st">'10%'</span>, type <span class="op">=</span> <span class="st">"covariance"</span>,  </span>
<span>param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/cov.png"></p>
<p>In the above example, the following covariance matrix has been used, which results in covering the data by fixed shape ellipses:</p>
<div class="figure">
<img src="https://azureblue.github.io/cec/static/covariance.png" alt=""><p class="caption">0.04 0.00 0.00 0.01<br></p>
</div>
</div>
<div class="section level3">
<h3 id="fixed-eigenvalues-cec">Fixed eigenvalues CEC<a class="anchor" aria-label="anchor" href="#fixed-eigenvalues-cec"></a>
</h3>
<p><strong><code>type = "eigenvalues"</code></strong></p>
<p>Model based on Gaussians with arbitrary fixed eigenvalues.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tset</span>, centers <span class="op">=</span> <span class="fl">10</span>, type <span class="op">=</span> <span class="st">"eigenvalues"</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span>, nstart <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/eigen.png"></p>
<p>In the above example, two eigenvalues: <strong>λ₁=0.01</strong> and <strong>λ₂=0.001</strong> are used, which results in covering the data with ellipses having fixed semi axes (corresponding to the eigenvalues).</p>
</div>
<div class="section level3">
<h3 id="fixed-mean-cec">Fixed mean CEC<a class="anchor" aria-label="anchor" href="#fixed-mean-cec"></a>
</h3>
<p><strong><code>type = "mean"</code></strong></p>
<p>Model based on Gaussians with fixed means.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Tset"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"threeGaussians"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">Tset</span>, <span class="fl">4</span>, <span class="st">"mean"</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.48</span>, <span class="fl">0.48</span><span class="op">)</span>, nstart <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">threeGaussians</span>,<span class="fl">4</span>, <span class="st">"mean"</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, nstart <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/mean1.png"><img src="https://azureblue.github.io/cec/static/mean2.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="a-mix-of-the-gaussian-models">A mix of the Gaussian models<a class="anchor" aria-label="anchor" href="#a-mix-of-the-gaussian-models"></a>
</h2>
<p>One of the most powerful properties of the CEC algorithm is the possibility of mixing models. More precisely, the mixed models can be specified by giving a list of cluster types (and a list of parameters if needed).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cec</span>(<span class="at">x =</span> ..., <span class="at">centers =</span> ..., <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"all"</span>, <span class="st">"diagonal"</span>, ...), <span class="at">param =</span> ...).</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mixShapes"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">mixShapes</span>, <span class="fl">7</span>, iter.max <span class="op">=</span> <span class="fl">3</span>, </span>
<span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixedr"</span>, <span class="st">"fixedr"</span>, <span class="st">"eigen"</span>, <span class="st">"eigen"</span>,  <span class="st">"eigen"</span>, <span class="st">"eigen"</span>, <span class="st">"eigen"</span><span class="op">)</span>,  </span>
<span>param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">350</span>, <span class="fl">350</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9000</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9000</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9000</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9000</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9000</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>, nstart <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/mix.png"></p>
</div>
<div class="section level2">
<h2 id="cec-split">CEC Split<a class="anchor" aria-label="anchor" href="#cec-split"></a>
</h2>
<p>CEC Split method discovers new clusters after initial clustering, by recursively trying to split each cluster into two with lower cost function.</p>
<p>To enable split method, the <code>split</code> argument must be set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">...</span>,  centers <span class="op">=</span> <span class="va">...</span>, split <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>There are four parameters (with their default values) that control the split mode: <code>split.depth = 8</code> , <code>split.tries   = 5</code>, <code>split.limit   = 100</code>, <code>split.initial.starts = 1</code>. The description of those parameters is provided in the package manual. Using <code>nstart</code> parameter, the whole procedure, from start to end (initial clustering and splitting), can be repeated multiple times. In this, case we can also use multiple threads (<code>threads</code> parameter).</p>
<p>An example usage is presented below:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fourGaussians"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">fourGaussians</span>, centers <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"all"</span>, split <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/split_4_gaussians.png"></p>
<p>The split method will be used implicitly when <code>centers</code> argument is not provided.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mixShapes"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">mixShapes</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/split_mix.png"></p>
<p>The next two examples show clustering results using split method on a data set of 20 gaussians generated by the following code:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twenty.gaussians</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>, <span class="fl">200</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">G</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">G</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">8</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">G</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">G</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">8</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">twenty.gaussians</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">twenty.gaussians</span>, <span class="va">G</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In the following example, the usage of general gaussian distributions (<code>type = 'all'</code>) doesn’t require any modification of default split parameters. Only the <code>card.min</code> needs to be set to a much lower value.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">twenty.gaussians</span>, card.min<span class="op">=</span><span class="st">"1%"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://azureblue.github.io/cec/static/split_20_gaussians_all.png"></p>
<p>Some data sets may require tuning of the split parameters. Using spherical densities (<code>type = 'spherical'</code>) on the same data, the <code>split.depth</code> needs to be increased significantly as well as <code>split.tries</code>. As in the previous example the <code>card.min</code> is changed.</p>
<pre><code><span><span class="va">cec</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cec.html">cec</a></span><span class="op">(</span><span class="va">twenty.gaussians</span>,, <span class="st">"sp"</span>, split.depth <span class="op">=</span> <span class="fl">25</span>, split.tries<span class="op">=</span><span class="fl">15</span>, card.min<span class="op">=</span><span class="st">"1%"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cec</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
<p><img src="https://azureblue.github.io/cec/static/split_20_gaussians_spherical.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=CEC" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/swarm-lab/cec/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CEC</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kamieniecki Konrad <br><small class="roles"> Author </small>  </li>
<li>
<a href="http://www.theswarmlab.com" class="external-link">Simon Garnier</a> <br><small class="roles"> Maintainer, contributor </small> <a href="https://orcid.org/0000-0002-3886-3974" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/swarm-lab/cec/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/swarm-lab/cec/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Kamieniecki Konrad, <a href="http://www.theswarmlab.com" class="external-link">Simon Garnier</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
